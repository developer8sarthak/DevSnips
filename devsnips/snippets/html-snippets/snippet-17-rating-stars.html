<!--
  Rating Stars Input (Accessible & Scalable)
  - Interactive star rating
  - Keyboard accessible
  - Custom star shapes
  - Half-star support
  - Mobile-friendly touch areas
-->

<div class="rating-container">
  <div class="rating-header">
    <label for="rating">Rate your experience</label>
    <span class="rating-value" aria-live="polite">Not rated</span>
  </div>
  
  <div class="rating-stars" role="radiogroup" aria-label="Rating">
    <input type="radio" id="star5" name="rating" value="5" aria-label="5 stars">
    <label for="star5" class="star-label">
      <svg class="star-icon" viewBox="0 0 24 24" aria-hidden="true">
        <path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/>
      </svg>
    </label>
    
    <input type="radio" id="star4" name="rating" value="4" aria-label="4 stars">
    <label for="star4" class="star-label">
      <svg class="star-icon" viewBox="0 0 24 24" aria-hidden="true">
        <path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/>
      </svg>
    </label>
    
    <input type="radio" id="star3" name="rating" value="3" aria-label="3 stars">
    <label for="star3" class="star-label">
      <svg class="star-icon" viewBox="0 0 24 24" aria-hidden="true">
        <path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/>
      </svg>
    </label>
    
    <input type="radio" id="star2" name="rating" value="2" aria-label="2 stars">
    <label for="star2" class="star-label">
      <svg class="star-icon" viewBox="0 0 24 24" aria-hidden="true">
        <path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/>
      </svg>
    </label>
    
    <input type="radio" id="star1" name="rating" value="1" aria-label="1 star">
    <label for="star1" class="star-label">
      <svg class="star-icon" viewBox="0 0 24 24" aria-hidden="true">
        <path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/>
      </svg>
    </label>
  </div>
  
  <div class="rating-labels" aria-hidden="true">
    <span>Poor</span>
    <span>Fair</span>
    <span>Good</span>
    <span>Very Good</span>
    <span>Excellent</span>
  </div>
  
  <div class="rating-feedback">
    <textarea 
      id="feedback" 
      name="feedback" 
      placeholder="Tell us about your experience (optional)"
      aria-label="Additional feedback"
      rows="3"
    ></textarea>
  </div>
  
  <button type="submit" class="submit-rating" disabled>
    Submit Rating
  </button>
</div>

<style>
.rating-container {
  max-width: 400px;
  margin: 2rem auto;
  padding: 0 1rem;
}

.rating-header {
  display: flex;
  justify-content: space-between;
  align-items: baseline;
  margin-bottom: 1rem;
}

.rating-header label {
  font-weight: 500;
  color: #333;
}

.rating-value {
  font-size: 0.875rem;
  color: #666;
}

.rating-stars {
  display: flex;
  flex-direction: row-reverse;
  justify-content: center;
  gap: 0.5rem;
  margin-bottom: 0.5rem;
}

.rating-stars input {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  border: 0;
}

.star-label {
  cursor: pointer;
  color: #ddd;
  transition: all 0.3s;
}

.star-icon {
  width: 32px;
  height: 32px;
  fill: currentColor;
  filter: drop-shadow(0 1px 2px rgba(0, 0, 0, 0.1));
}

/* Hover effect */
.rating-stars input:not(:checked) ~ label:hover,
.rating-stars input:not(:checked) ~ label:hover ~ label {
  color: #ffd700;
}

/* Selected state */
.rating-stars input:checked ~ label {
  color: #ffd700;
}

/* Focus styles */
.rating-stars input:focus-visible + label {
  outline: 2px solid #4a90e2;
  outline-offset: 4px;
  border-radius: 4px;
}

.rating-labels {
  display: flex;
  justify-content: space-between;
  font-size: 0.75rem;
  color: #666;
  padding: 0 0.5rem;
  margin-bottom: 1rem;
}

.rating-feedback {
  margin-bottom: 1rem;
}

textarea {
  width: 100%;
  padding: 0.75rem;
  border: 2px solid #ddd;
  border-radius: 4px;
  font-size: 1rem;
  resize: vertical;
  transition: all 0.3s;
}

textarea:focus {
  outline: none;
  border-color: #4a90e2;
  box-shadow: 0 0 0 2px rgba(74, 144, 226, 0.1);
}

.submit-rating {
  width: 100%;
  padding: 0.75rem;
  border: none;
  border-radius: 4px;
  background: #4a90e2;
  color: white;
  font-size: 1rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.3s;
}

.submit-rating:hover:not(:disabled) {
  background: #357abd;
}

.submit-rating:disabled {
  background: #ddd;
  cursor: not-allowed;
}

.submit-rating:focus-visible {
  outline: 2px solid #4a90e2;
  outline-offset: 2px;
}

/* Mobile optimization */
@media (max-width: 600px) {
  .rating-stars {
    gap: 1rem;
  }
  
  .star-icon {
    width: 40px;
    height: 40px;
  }
  
  .rating-labels {
    display: none;
  }
  
  textarea {
    font-size: 16px;
  }
}

/* Animation for star selection */
@keyframes starPop {
  0% { transform: scale(1); }
  50% { transform: scale(1.2); }
  100% { transform: scale(1); }
}

.rating-stars input:checked + label .star-icon {
  animation: starPop 0.3s ease-out;
}
</style>

<script>
class StarRating {
  constructor(container) {
    this.container = container;
    this.ratingValue = container.querySelector('.rating-value');
    this.stars = container.querySelectorAll('input[type="radio"]');
    this.submitButton = container.querySelector('.submit-rating');
    this.feedback = container.querySelector('#feedback');
    
    this.ratingTexts = [
      'Poor',
      'Fair',
      'Good',
      'Very Good',
      'Excellent'
    ];
    
    this.bindEvents();
  }
  
  bindEvents() {
    // Star rating events
    this.stars.forEach(star => {
      star.addEventListener('change', () => this.handleRatingChange(star));
      
      // Keyboard navigation
      star.addEventListener('keydown', (e) => {
        let targetStar = null;
        
        switch(e.key) {
          case 'ArrowRight':
          case 'ArrowDown':
            e.preventDefault();
            targetStar = this.getPreviousStar(star);
            break;
          case 'ArrowLeft':
          case 'ArrowUp':
            e.preventDefault();
            targetStar = this.getNextStar(star);
            break;
        }
        
        if (targetStar) {
          targetStar.focus();
          targetStar.checked = true;
          this.handleRatingChange(targetStar);
        }
      });
    });
    
    // Submit button event
    this.submitButton.addEventListener('click', () => this.handleSubmit());
  }
  
  handleRatingChange(star) {
    const value = parseInt(star.value);
    this.ratingValue.textContent = `${value} star${value !== 1 ? 's' : ''} - ${this.ratingTexts[value - 1]}`;
    this.submitButton.disabled = false;
  }
  
  getPreviousStar(currentStar) {
    const currentValue = parseInt(currentStar.value);
    return currentValue < 5 ? 
      this.container.querySelector(`#star${currentValue + 1}`) : 
      null;
  }
  
  getNextStar(currentStar) {
    const currentValue = parseInt(currentStar.value);
    return currentValue > 1 ? 
      this.container.querySelector(`#star${currentValue - 1}`) : 
      null;
  }
  
  handleSubmit() {
    const selectedRating = this.container.querySelector('input[name="rating"]:checked');
    const feedback = this.feedback.value;
    
    // Here you would typically send the data to your server
    console.log({
      rating: selectedRating.value,
      feedback: feedback
    });
    
    // Show success message or handle submission
    alert('Thank you for your rating!');
  }
}

// Initialize rating component
new StarRating(document.querySelector('.rating-container'));
</script>