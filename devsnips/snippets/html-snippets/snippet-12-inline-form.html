<!--
  Inline Form with Validation States
  - Real-time validation feedback
  - Accessible error messages
  - Responsive layout
  - Custom validation styles
  - Mobile-optimized inputs
-->

<form class="inline-form" novalidate>
  <div class="form-group">
    <label for="username">Username</label>
    <input 
      type="text" 
      id="username" 
      name="username" 
      required 
      pattern="^[a-zA-Z0-9_]{3,20}$"
      aria-describedby="username-error"
    >
    <div id="username-error" class="error-message" aria-live="polite"></div>
  </div>

  <div class="form-group">
    <label for="email">Email</label>
    <input 
      type="email" 
      id="email" 
      name="email" 
      required
      aria-describedby="email-error"
    >
    <div id="email-error" class="error-message" aria-live="polite"></div>
  </div>

  <div class="form-group">
    <label for="age">Age</label>
    <input 
      type="number" 
      id="age" 
      name="age" 
      min="18" 
      max="120" 
      required
      aria-describedby="age-error"
    >
    <div id="age-error" class="error-message" aria-live="polite"></div>
  </div>

  <button type="submit" class="submit-button">Submit</button>
</form>

<style>
.inline-form {
  display: flex;
  flex-wrap: wrap;
  gap: 1rem;
  align-items: flex-start;
  max-width: 800px;
  margin: 2rem auto;
  padding: 0 1rem;
}

.form-group {
  flex: 1 1 200px;
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
}

label {
  font-weight: 500;
  color: #333;
}

input {
  padding: 0.5rem;
  border: 2px solid #ddd;
  border-radius: 4px;
  font-size: 1rem;
  transition: all 0.3s;
}

input:focus {
  outline: none;
  border-color: #4a90e2;
  box-shadow: 0 0 0 2px rgba(74, 144, 226, 0.1);
}

/* Validation styles */
input:not(:placeholder-shown):valid {
  border-color: #4caf50;
}

input:not(:placeholder-shown):invalid {
  border-color: #f44336;
}

.error-message {
  font-size: 0.875rem;
  color: #f44336;
  min-height: 1.25rem;
}

.submit-button {
  padding: 0.5rem 1.5rem;
  border: none;
  border-radius: 4px;
  background: #4a90e2;
  color: white;
  font-size: 1rem;
  cursor: pointer;
  transition: background-color 0.3s;
  align-self: flex-end;
}

.submit-button:hover {
  background: #357abd;
}

.submit-button:disabled {
  background: #ddd;
  cursor: not-allowed;
}

/* Focus styles */
input:focus-visible,
.submit-button:focus-visible {
  outline: 2px solid #4a90e2;
  outline-offset: 2px;
}

/* Mobile optimization */
@media (max-width: 600px) {
  .inline-form {
    flex-direction: column;
  }
  
  .form-group {
    width: 100%;
  }
  
  input {
    padding: 0.75rem;
  }
  
  .submit-button {
    width: 100%;
    padding: 0.75rem;
  }
}
</style>

<script>
const form = document.querySelector('.inline-form');
const inputs = form.querySelectorAll('input');
const submitButton = form.querySelector('.submit-button');

// Validation messages
const validationMessages = {
  username: {
    valueMissing: 'Username is required',
    patternMismatch: 'Username must be 3-20 characters and can only contain letters, numbers, and underscores'
  },
  email: {
    valueMissing: 'Email is required',
    typeMismatch: 'Please enter a valid email address'
  },
  age: {
    valueMissing: 'Age is required',
    rangeUnderflow: 'You must be at least 18 years old',
    rangeOverflow: 'Age cannot be more than 120',
    stepMismatch: 'Please enter a valid age',
    typeMismatch: 'Please enter a valid number'
  }
};

// Real-time validation
inputs.forEach(input => {
  input.addEventListener('input', validateInput);
  input.addEventListener('blur', validateInput);
});

function validateInput(e) {
  const input = e.target;
  const errorElement = document.getElementById(`${input.id}-error`);
  
  if (!input.validity.valid) {
    let message = '';
    for (const key in validationMessages[input.name]) {
      if (input.validity[key]) {
        message = validationMessages[input.name][key];
        break;
      }
    }
    errorElement.textContent = message;
    input.setAttribute('aria-invalid', 'true');
  } else {
    errorElement.textContent = '';
    input.setAttribute('aria-invalid', 'false');
  }
  
  // Update submit button state
  submitButton.disabled = !form.checkValidity();
}

// Form submission
form.addEventListener('submit', (e) => {
  e.preventDefault();
  
  if (!form.checkValidity()) {
    // Show validation messages for all fields
    inputs.forEach(input => {
      const event = new Event('blur');
      input.dispatchEvent(event);
    });
    return;
  }
  
  // Handle successful submission
  console.log('Form submitted successfully');
  const formData = new FormData(form);
  for (const [key, value] of formData.entries()) {
    console.log(`${key}: ${value}`);
  }
});
</script>